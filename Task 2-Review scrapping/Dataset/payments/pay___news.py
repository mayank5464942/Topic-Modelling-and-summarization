# -*- coding: utf-8 -*-
"""pay & news.ipynb

Automatically generated by Colaboratory.

Original file is located at
    https://colab.research.google.com/drive/1UfKCMOQozepeBmxj948fhdpH6wvzX1zj
"""

pip install google-play-scraper

#top 10 apps in finance sector (payment apps not trading apps)
top10=['com.google.android.apps.nbu.paisa.user', #gpay
      'com.phonepe.app', #phonepay
      'com.sbi.lotusintouch', #yonosbi
      'com.indiaBulls', #dhani
      'in.org.npci.upiapp',#bhim
      'com.bankofbaroda.mconnect',#mconnectplus
      'com.sbi.SBIFreedomPlus', #yonosbilite
      'com.mobikwik_new.bajajfinserv', #bajajfinserv
      'com.iexceed.appzillon.ippbMB', #ippb
      'com.gocash.liufang'] #gocash

news10=[
        'com.cardfeed.video_public', #public
        'in.AajTak.headlines', #aajtak
        'com.ak.ta.dainikbhaskar.activity',#dainikbhaskar
        'com.eterno', #dailyhunt
        'com.nis.app', #inshorts
        'sun.way2sms.hyd.com', #way2news
        'com.jio.media.jioxpressnews', #jionews
        'com.mobstac.thehindu', #thehindu
        'com.july.ndtv', #ndtv
        'com.indianexpress.android' #indianexpress
]

import pandas as pd
finalpay=pd.DataFrame()
finalnews=pd.DataFrame()
from google_play_scraper import Sort, reviews
for i in top10:
  result,_= reviews(
    i,
    lang='en', # defaults to 'en'
    country='in', 
    sort=Sort.MOST_RELEVANT, 
    count=1000, # defaults to 1000
    filter_score_with=None
    )
  lol=pd.DataFrame(result)
  lol.insert(0,'apppackage',i)
  finalpay= pd.concat([finalpay,lol])
  
for i in news10:
  result,_= reviews(
    i,
    lang='en', # defaults to 'en'
    country='in', 
    sort=Sort.MOST_RELEVANT, 
    count=1000, # defaults to 1000
    filter_score_with=None
    )
  lol=pd.DataFrame(result)
  lol.insert(0,'apppackage',i)
  finalnews= pd.concat([finalnews,lol])

print(finalnews.head())
print(finalpay.head())
print(finalnews.columns)

extractpay= finalpay.iloc[:,[0,1,2,4,5,6,8]]
extractnews= finalnews.iloc[:,[0,1,2,4,5,6,8]]

extractpay.head()

extractnews.head()

extractnews.to_csv("/content/drive/My Drive/dusra/tonews.csv",index=False)
extractpay.to_csv("/content/drive/My Drive/dusra/topay.csv",index=False)

